<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jeu : Trouve l'intrus - Les H√©ros Invisibles</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background: linear-gradient(to top, #80c241 0%, #dff5e5 50%, #a3e3f5 100%);
      color: #2c3e50;
      min-height: 100vh;
    }
    h1 { color: #27ae60; }
    #level-buttons { margin: 20px 0; }
    #level-buttons button {
      margin: 5px;
      padding: 12px 20px;
      background-color: #27ae60;
      border: none;
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.2s;
    }
    #level-buttons button:hover { background-color: #1e884a; }
    .score { font-size: 1.4em; margin-top: 12px; }
    .game-area { display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; margin-top: 25px; }
    .item {
      background-color: rgba(255,255,255,0.8);
      border: 2px solid #27ae60;
      border-radius: 12px;
      width: 140px;
      height: 160px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 8px;
      box-sizing: border-box;
    }
    .item:hover {
      transform: scale(1.05);
      background-color: rgba(255,255,255,1);
    }
    .item img { 
      max-width: 80%; 
      max-height: 80%; 
      object-fit: cover;
      border-radius: 8px;
    }
    .item-name {
      font-size: 0.8em;
      font-weight: bold;
      color: #2c3e50;
      margin-top: 5px;
      text-align: center;
      line-height: 1.1;
    }
    .message { margin-top: 22px; font-weight: bold; font-size: 1.2em; }
    .info {
      margin-top: 14px;
      font-size: 0.95em;
      text-align: left;
      padding: 18px;
      background-color: rgba(255,255,255,0.9);
      border: 1px solid #27ae60;
      border-radius: 8px;
      max-width: 680px;
      margin: 14px auto;
      line-height: 1.4;
      white-space: pre-line;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .info img {
      width: 100%;
      max-width: 300px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>
  <h1>‚≠ê Trouve l'intrus : Les H√©ros Invisibles ‚≠ê</h1>
  <p>Le but ? D√©masquer l'esp√®ce en danger pour mieux la prot√©ger !</p>
  <div id="level-buttons">
    <button onclick="startGame('facile')">Facile (4 choix)</button>
    <button onclick="startGame('moyen')">Moyen (6 choix)</button>
    <button onclick="startGame('difficile')">Difficile (8 choix)</button>
  </div>
  <div class="score" id="scoreDisplay" style="display:none;">Score : 0</div>
  <div class="game-area" id="gameArea"></div>
  <div class="message" id="message"></div>
  <div class="info" id="info"></div>

  <script>
    // === LISTES DES ESP√àCES ===
    
    // ü¶∏ Intrus (esp√®ces menac√©es √† prot√©ger)
    const endangeredSpecies = [
      "M√©lib√©e",
      "Vanesse des pari√©taires", 
      "Agrion bleuissant",
      "Cordulie splendide",
      "Serratella mesoleuca",
      "Halictus carinthiacus",
      "Bourdon velout√©",
      "Criquet de la Crau",
      "Phasme du palmiste rouge",
      "Dendrobias maxillosus"
    ];

    // üêû D√©coys (esp√®ces non menac√©es)
    const commonSpecies = [
      "Chauve-souris frugivore",
      "Colibri",
      "Mouche domestique",
      "Fourmi noire",
      "Papillon commun",
      "Abeille domestique",
      "Sauterelle verte",
      "Scarab√©e commun",
      "Coccinelle √† sept points",
      "Termite des for√™ts",
      "Grillon champ√™tre",
      "Larve de coccinelle",
      "Cicadelle",
      "Lucane cerf-volant",
      "Punaise verte",
      "Mite des v√™tements",
      "Perce-oreille",
      "Loup",
      "Renard",
      "Chat",
      "Chien",
      "Pigeon"
    ];

    // === D√âFINITIONS ET GESTES DE PROTECTION ===
    const definitions = {
      // Esp√®ces menac√©es
      "M√©lib√©e": `ü¶ã **M√©lib√©e**
1. Papillon rare des prairies humides, reconnaissable √† ses ailes oranges tachet√©es de noir.
2. Pollinisateur sp√©cialis√© des fleurs de prairie, indispensable √† la biodiversit√© montagnarde.
3. Menac√© par l'ass√®chement des zones humides et l'agriculture intensive.
**Gestes** : Pr√©serve les prairies fleuries, √©vite les pesticides, cr√©e des corridors verts.`,

      "Vanesse des pari√©taires": `ü¶ã **Vanesse des pari√©taires**
1. Papillon aux ailes d√©coup√©es, d√©pendant exclusivement de la pari√©taire officinale.
2. Exemple parfait de co√©volution : chenille-plante h√¥te indissociables.
3. Menac√©e par le nettoyage urbain et l'usage d'herbicides.
**Gestes** : Laisse pousser la pari√©taire sur tes murs, √©vite les d√©sherbants chimiques.`,

      "Agrion bleuissant": `üíß **Agrion bleuissant**
1. Petite libellule bleue vivant pr√®s des cours d'eau clairs et oxyg√©n√©s.
2. Pr√©dateur de moustiques efficace, indicateur de qualit√© des milieux aquatiques.
3. Menac√© par la pollution de l'eau et l'artificialisation des berges.
**Gestes** : Prot√®ge les ruisseaux, √©vite les produits chimiques pr√®s de l'eau.`,

      "Cordulie splendide": `‚ú® **Cordulie splendide**
1. Libellule m√©tallique des mares temporaires m√©diterran√©ennes.
2. Vol spectaculaire et chasse a√©rienne remarquable contre les insectes nuisibles.
3. Menac√©e par la disparition des zones humides temporaires.
**Gestes** : Cr√©e des mares naturelles, respecte les flaques temporaires.`,

      "Serratella mesoleuca": `üí¶ **Serratella mesoleuca**
1. √âph√©m√®re aux larves aquatiques, vie adulte de quelques heures seulement.
2. Maillon essentiel de la cha√Æne alimentaire des rivi√®res.
3. Menac√©e par la pollution et la modification des cours d'eau.
**Gestes** : Prot√®ge la v√©g√©tation des berges, √©vite les rejets polluants.`,

      "Halictus carinthiacus": `üêù **Halictus carinthiacus**
1. Abeille sauvage solitaire, excellente pollinisatrice des fleurs alpines.
2. Creuse ses nids dans le sol, plus efficace que l'abeille domestique sur certaines fleurs.
3. Menac√©e par l'urbanisation et le pi√©tinement des sols.
**Gestes** : Pr√©serve les sols nus, plante des fleurs locales, √©vite le b√™chage.`,

      "Bourdon velout√©": `üêù **Bourdon velout√©**
1. Bourdon au pelage dense, sp√©cialis√© dans la pollinisation par vibration.
2. Pollinisateur irrempla√ßable des tomates et autres solanac√©es.
3. Menac√© par les pesticides et la rar√©faction des fleurs sauvages.
**Gestes** : Plante des fleurs mellif√®res, bannis les insecticides, cr√©e des abris.`,

      "Criquet de la Crau": `ü¶ó **Criquet de la Crau**
1. Criquet end√©mique de la plaine de la Crau, habitat unique au monde.
2. Indicateur de la sant√© des √©cosyst√®mes de coussouls (pelouses s√®ches).
3. Menac√© par l'urbanisation et l'agriculture intensive.
**Gestes** : Soutiens la protection des espaces naturels, respecte les pelouses s√®ches.`,

      "Phasme du palmiste rouge": `üåø **Phasme du palmiste rouge**
1. Insecte-b√¢ton tropical, ma√Ætre du camouflage dans les palmiers.
2. Herbivore sp√©cialis√©, participant √† l'√©quilibre des for√™ts tropicales.
3. Menac√© par la d√©forestation et les esp√®ces invasives.
**Gestes** : Soutiens la protection des for√™ts tropicales, choisis des produits durables.`,

      "Dendrobias maxillosus": `ü™≤ **Dendrobias maxillosus**
1. Col√©opt√®re saproxylique, d√©composeur de bois mort essentiel.
2. Indicateur de la qualit√© des vieilles for√™ts, recycleur naturel.
3. Menac√© par l'exploitation foresti√®re intensive et le nettoyage des for√™ts.
**Gestes** : Laisse du bois mort en for√™t, soutiens la gestion durable des for√™ts.`,

      // Esp√®ces communes (descriptions plus courtes)
      "Chauve-souris frugivore": `ü¶á **Chauve-souris frugivore**
Mammif√®re volant, disperse les graines des fruits.
Population stable, adaptable aux environnements vari√©s.`,

      "Colibri": `üê¶ **Colibri**
Oiseau-mouche, pollinisateur de fleurs tubulaires.
Esp√®ce commune dans son habitat naturel.`,

      "Mouche domestique": `ü™∞ **Mouche domestique**
Insecte ubiquiste, recycle la mati√®re organique.
Tr√®s commune, non menac√©e.`,

      "Fourmi noire": `üêú **Fourmi noire**
Insecte social, a√®re le sol et disperse les graines.
Population abondante et stable.`,

      "Papillon commun": `ü¶ã **Papillon commun**
Pi√©ride blanche, pollinisateur occasionnel des jardins.
Tr√®s r√©pandu, population en bonne sant√©.`,

      "Abeille domestique": `üêù **Abeille domestique**
Hym√©nopt√®re √©lev√© par l'homme, pollinisateur efficace.
G√©r√©e par l'apiculture, non sauvage.`,

      "Sauterelle verte": `ü¶ó **Sauterelle verte**
Orthopt√®re herbivore des prairies et jardins.
Commune partout, tr√®s adaptable.`,

      "Scarab√©e commun": `ü™≤ **Scarab√©e commun**
Col√©opt√®re d√©composeur, recycle la mati√®re organique.
Population stable, pas de menace particuli√®re.`,

      "Coccinelle √† sept points": `üêû **Coccinelle √† sept points**
Pr√©dateur naturel des pucerons, auxiliaire du jardinier.
Tr√®s commune, non menac√©e.`,

      "Termite des for√™ts": `üêú **Termite des for√™ts**
Insecte social d√©composeur, recycle le bois mort.
Population stable dans les for√™ts.`,

      "Grillon champ√™tre": `ü¶ó **Grillon champ√™tre**
Orthopt√®re chanteur des prairies et jardins.
Tr√®s commun, non menac√©.`,

      "Larve de coccinelle": `üêõ **Larve de coccinelle**
Stade juv√©nile de coccinelle, grand pr√©dateur de pucerons.
Abondante, non menac√©e.`,

      "Cicadelle": `ü¶ó **Cicadelle**
Petit insecte sauteur se nourrissant de s√®ve.
Tr√®s commune, non menac√©e.`,

      "Lucane cerf-volant": `ü™≤ **Lucane cerf-volant**
Grand col√©opt√®re aux mandibules impressionnantes.
Relativement commun, non menac√© globalement.`,

      "Punaise verte": `üêõ **Punaise verte**
Insecte herbivore des jardins et cultures.
Tr√®s commune, parfois consid√©r√©e comme nuisible.`,

      "Mite des v√™tements": `ü¶ã **Mite des v√™tements**
Petit papillon dont la larve mange les textiles.
Tr√®s commune dans les habitations.`,

      "Perce-oreille": `ü¶ó **Perce-oreille**
Insecte aux pinces caract√©ristiques, omnivore.
Tr√®s commun, non menac√©.`,

      "Loup": `üê∫ **Loup**
Mammif√®re carnivore, pr√©dateur apex.
Population en r√©cup√©ration, non insecte.`,

      "Renard": `ü¶ä **Renard**
Mammif√®re omnivore adaptable.
Population stable, non insecte.`,

      "Chat": `üê± **Chat**
Mammif√®re domestique, pr√©dateur d'oiseaux et petits animaux.
Tr√®s commun, non insecte.`,

      "Chien": `üê∂ **Chien**
Mammif√®re domestique, compagnon de l'homme.
Tr√®s commun, non insecte.`,

      "Pigeon": `üê¶ **Pigeon**
Oiseau urbain tr√®s adaptable.
Tr√®s commun en ville, non insecte.`
    };

    // === CONFIGURATION DU JEU ===
    const gameConfig = {
      facile: { choices: 4, rounds: 5 },
      moyen: { choices: 6, rounds: 7 },
      difficile: { choices: 8, rounds: 10 }
    };

    // Variables de jeu
    let score = 0;
    let correctStreak = 0;
    let wrongStreak = 0;
    let currentRound = 0;
    let totalRounds = 0;
    let currentLevel = '';
    let usedEndangered = [];

    const scoreDisplay = document.getElementById('scoreDisplay');
    const infoDiv = document.getElementById('info');
    const levelButtons = document.getElementById('level-buttons');
    const messageDiv = document.getElementById('message');
    const gameArea = document.getElementById('gameArea');

    // === FONCTIONS UTILITAIRES ===
    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    function getImagePath(speciesName) {
      return `images/${speciesName}.jpg`;
    }

    // === D√âMARRAGE DU JEU ===
    function startGame(level) {
      currentLevel = level;
      currentRound = 0;
      score = 0;
      correctStreak = 0;
      wrongStreak = 0;
      usedEndangered = [];
      
      totalRounds = gameConfig[level].rounds;
      
      levelButtons.style.display = 'none';
      scoreDisplay.style.display = 'block';
      updateScore();
      infoDiv.innerHTML = '';
      
      showRound();
    }

    // === AFFICHAGE D'UNE MANCHE ===
    function showRound() {
      infoDiv.innerHTML = '';
      messageDiv.textContent = `Manche ${currentRound + 1}/${totalRounds}`;
      messageDiv.style.color = '#2c3e50';
      
      // Choisir un intrus qui n'a pas encore √©t√© utilis√©
      const availableEndangered = endangeredSpecies.filter(species => !usedEndangered.includes(species));
      if (availableEndangered.length === 0) {
        // Si tous ont √©t√© utilis√©s, on recommence la liste
        usedEndangered = [];
      }
      
      const intrus = availableEndangered[Math.floor(Math.random() * availableEndangered.length)];
      usedEndangered.push(intrus);
      
      // Choisir les d√©coys
      const nbChoices = gameConfig[currentLevel].choices;
      const choices = shuffle(commonSpecies).slice(0, nbChoices - 1);
      
      // M√©langer tous les √©l√©ments
      const items = shuffle([...choices, intrus]);
      
      // Afficher les cartes
      gameArea.innerHTML = '';
      items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'item';
        
        // Container pour l'image
        const imgContainer = document.createElement('div');
        imgContainer.style.flex = '1';
        imgContainer.style.display = 'flex';
        imgContainer.style.alignItems = 'center';
        imgContainer.style.justifyContent = 'center';
        
        // Image
        const img = document.createElement('img');
        img.src = getImagePath(item);
        img.alt = item;
        img.onerror = function() {
          imgContainer.innerHTML = `<div style="text-align:center; font-size:0.9em; color:#666;">üì∑<br>Image manquante</div>`;
        };
        imgContainer.appendChild(img);
        
        // Nom de l'esp√®ce
        const nameDiv = document.createElement('div');
        nameDiv.className = 'item-name';
        nameDiv.textContent = item;
        
        div.appendChild(imgContainer);
        div.appendChild(nameDiv);
        div.onclick = () => handleClick(item, intrus);
        gameArea.appendChild(div);
      });
    }

    // === GESTION DU CLIC ===
    function handleClick(item, intrus) {
      // Afficher les informations sur l'esp√®ce
      const detailImg = `<img src="${getImagePath(item)}" alt="${item}">`;
      infoDiv.innerHTML = detailImg + definitions[item];
      
      if (item === intrus) {
        // Bonne r√©ponse !
        wrongStreak = 0;
        correctStreak++;
        const bonus = 10 + correctStreak * 2; // 12, 14, 16...
        score += bonus;
        messageDiv.textContent = `‚úÖ Bravo ! Esp√®ce prot√©g√©e : ${item} (+${bonus} pts)`;
        messageDiv.style.color = '#27ae60';
        
        currentRound++;
        updateScore();
        
        setTimeout(() => {
          if (currentRound < totalRounds) {
            showRound();
          } else {
            finishGame();
          }
        }, 3000);
        
      } else {
        // Mauvaise r√©ponse
        correctStreak = 0;
        wrongStreak++;
        const penalty = wrongStreak * 3;
        score = Math.max(0, score - penalty);
        messageDiv.textContent = `‚ùå ${item} n'est pas une esp√®ce √† prot√©ger (-${penalty} pts)`;
        messageDiv.style.color = '#c0392b';
        updateScore();
      }
    }

    // === FIN DE PARTIE ===
    function finishGame() {
      gameArea.innerHTML = '';
      
      let performance = '';
      if (score >= totalRounds * 10) performance = 'üèÜ Excellent !';
      else if (score >= totalRounds * 7) performance = 'ü•á Tr√®s bien !';
      else if (score >= totalRounds * 5) performance = 'ü•à Bien !';
      else performance = 'ü•â √Ä am√©liorer !';
      
      messageDiv.innerHTML = `
        <div style="font-size: 1.4em; margin-bottom: 10px;">${performance}</div>
        <div>Score final : ${score} points</div>
        <div style="font-size: 0.9em; margin-top: 10px;">
          Merci d'avoir jou√© pour la protection de la biodiversit√© !
        </div>
      `;
      messageDiv.style.color = '#27ae60';
      
      infoDiv.innerHTML = '';
      levelButtons.style.display = 'block';
      scoreDisplay.style.display = 'none';
    }

    // === MISE √Ä JOUR DU SCORE ===
    function updateScore() {
      scoreDisplay.textContent = `Score : ${score}`;
    }
  </script>
</body>
</html>
