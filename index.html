<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Jeu : Trouve l'intrus - Les H√©ros Invisibles</title>
  <style>
    /* Fond inspir√© de la palette et ambiance Ciao Kombucha */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 20px;
      background: linear-gradient(to top, #80c241 0%, #dff5e5 50%, #a3e3f5 100%);
      color: #2c3e50;
      min-height: 100vh;
    }
    h1 { color: #27ae60; }
    #level-buttons { margin: 20px 0; }
    #level-buttons button {
      margin: 5px;
      padding: 12px 20px;
      background-color: #27ae60;
      border: none;
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.2s;
    }
    #level-buttons button:hover { background-color: #1e884a; }
    .score { font-size: 1.4em; margin-top: 12px; }
    .game-area { display: flex; flex-wrap: wrap; justify-content: center; gap: 16px; margin-top: 25px; }
    .item {
      background-color: rgba(255,255,255,0.8);
      border: 2px solid #27ae60;
      border-radius: 12px;
      width: 140px;
      height: 160px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      padding: 8px;
      box-sizing: border-box;
    }
    .item:hover {
      transform: scale(1.05);
      background-color: rgba(255,255,255,1);
    }
    .item img { 
      max-width: 80%; 
      max-height: 80%; 
      object-fit: cover;
      border-radius: 8px;
    }
    .item-name {
      font-size: 0.8em;
      font-weight: bold;
      color: #2c3e50;
      margin-top: 5px;
      text-align: center;
      line-height: 1.1;
    }
    .message { margin-top: 22px; font-weight: bold; font-size: 1.2em; }
    .info {
      margin-top: 14px;
      font-size: 0.95em;
      text-align: left;
      padding: 18px;
      background-color: rgba(255,255,255,0.9);
      border: 1px solid #27ae60;
      border-radius: 8px;
      max-width: 680px;
      margin: 14px auto;
      line-height: 1.4;
      white-space: pre-line;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05);
    }
    .info img {
      width: 100%;
      max-width: 300px;
      border-radius: 8px;
      margin-bottom: 10px;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>
  <h1>‚≠ê Trouve l'intrus : Les H√©ros Invisibles ‚≠ê</h1>
  <p>Le but ? D√©masquer l'insecte en danger pour mieux le prot√©ger !</p>
  <div id="level-buttons">
    <button onclick="startGame('facile')">Facile</button>
    <button onclick="startGame('moyen')">Moyen</button>
    <button onclick="startGame('difficile')">Difficile</button>
  </div>
  <div class="score" id="scoreDisplay" style="display:none;">Score : 0</div>
  <div class="game-area" id="gameArea"></div>
  <div class="message" id="message"></div>
  <div class="info" id="info"></div>
  <script>
    // Mapping des noms d'esp√®ces vers les fichiers images
    const imageMapping = {
      // Esp√®ces menac√©es
      "M√©lib√©e": "M√©lib√©e.jpg",
      "Agrion bleuissant": "Agrion bleuissant (Ischnura elegans).jpg",
      "Cordulie splendide": "Cordulie splendide (Somatochlora metallica).jpg",
      "Serratella mesoleuca": "Serratella mesoleuca (Serratella mesoleuca).jpg",
      "Vanesse des pari√©taires": "Vanesse des pari√©taires.jpg",
      // Esp√®ces communes (leurres)
      "Mouche domestique": "Mouche.jpg",
      "Fourmi": "Fourmi noire (Lasius niger).jpg",
      "Papillon commun": "Papillon citron (Gonepteryx rhamni).jpg",
      "Scarab√©e commun": "Scarab√©e commun (Geotrupes stercorarius or Scarabaeus sacer).jpg",
      "Sauterelle verte": "Grillon champ√™tre (Gryllus campestris).jpg"
    };

    // D√©finitions type Wikip√©dia et gestes
    const definitions = {
      "M√©lib√©e": `üêõ **M√©lib√©e**
1. Insecte sauvage des prairies humides montagneuses, ailes gris-brun orn√©es d'ocelles orang√©s.
2. Pollinisateur essentiel du tr√®fle, base de la cha√Æne alimentaire locale.
3. Menac√© par la disparition des prairies humides et les monocultures.
**Gestes** : Plante des gramin√©es et fleurs sauvages, prot√®ge les zones humides pr√®s de chez toi.`,
      "Agrion bleuissant": `üíß **Agrion bleuissant**
1. Petite libellule aquatique au corps bleu et noir, larves vivant dans les ruisseaux clairs.
2. R√©gulateur naturel des populations de moustiques, indicateur de qualit√© de l'eau.
3. Menac√© par l'ass√®chement des cours d'eau et la pollution agricole.
**Gestes** : Cr√©e un petit bassin sans pesticides, plante une bande tampon v√©g√©talis√©e.`,
      "Cordulie splendide": `‚ú® **Cordulie splendide**
1. Libellule au corps m√©tallique vert, fr√©quente les mares m√©diterran√©ennes.
2. Pr√©dateur efficace des moustiques, gr√¢ce √† son vol acrobatique.
3. Menac√©e par la pollution lumineuse et la destruction des zones humides.
**Gestes** : Installe des √©clairages √† spectre adapt√©, restaure et prot√®ge les mares locales.`,
      "Serratella mesoleuca": `üí¶ **Serratella mesoleuca**
1. √âph√©m√®re d'eau douce, nymphes aquatiques jusqu'√† 3 ans avant leur vie br√®ve de quelques heures.
2. Nourrit essentiel pour poissons et oiseaux, bio-indicateur des rivi√®res saines.
3. Menac√©e par le dragage et l'artificialisation des berges.
**Gestes** : Encourage la v√©g√©tation naturelle des berges, limite les travaux lourds en rivi√®re.`,
      "Vanesse des pari√©taires": `ü¶ã **Vanesse des pari√©taires**
1. Papillon fauve aux ailes tr√®s d√©coup√©es, vivant sur les murs chauds o√π pousse la pari√©taire.
2. Chenille d√©pendante de la pari√©taire officinale, illustrant l'importance des plantes-h√¥tes.
3. Menac√©e par la b√©tonisation et le nettoyage des murs.
**Gestes** : Laisse pousser la pari√©taire sur un mur, √©vite les herbicides et nettoyages intempestifs.`,
      // D√©coys succincts
      "Mouche domestique": `üêú **Mouche domestique**
Insecte ubiquitaire, recycle les d√©chets organiques.
Non menac√©e, pas besoin de protection.`,
      "Fourmi": `üêú **Fourmi**
Sociale, vit en colonies complexes, a√®re le sol.
Esp√®ce commune, non en danger.`,
      "Papillon commun": `ü¶ã **Papillon commun (pi√©ride)**
Blanc fr√©quent dans les jardins, pollinise occasionnellement.
R√©silient, non menac√©.`,
      "Scarab√©e commun": `üêû **Scarab√©e commun**
Col√©opt√®re d√©truisant la mati√®re organique morte.
Population stable, pas besoin de mesures sp√©ciales.`,
      "Sauterelle verte": `ü¶ó **Sauterelle verte**
Sauteuse des prairies, herbivore mod√©r√©.
Commun, non menac√©e.`
    };

    // Param√®tres de jeu
    const levels = {
      facile: ["M√©lib√©e","Agrion bleuissant","Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires"],
      moyen: ["Agrion bleuissant","Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires","M√©lib√©e"],
      difficile: ["Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires","M√©lib√©e","Agrion bleuissant"]
    };
    const decoys = ["Mouche domestique","Fourmi","Papillon commun","Scarab√©e commun","Sauterelle verte"];
    let score = 0, correctStreak = 0, wrongStreak = 0, currentLevel = [], currentStep = 0;
    const scoreDisplay = document.getElementById('scoreDisplay');
    const infoDiv = document.getElementById('info');
    const levelButtons = document.getElementById('level-buttons');

    function startGame(level) {
      currentLevel = levels[level]; currentStep = 0; score = 0;
      correctStreak = 0; wrongStreak = 0;
      levelButtons.style.display = 'none'; scoreDisplay.style.display = 'block'; updateScore(); infoDiv.innerHTML = '';
      showStep();
    }

    function showStep() {
      infoDiv.innerHTML = ''; document.getElementById('message').textContent = '';
      const intrus = currentLevel[currentStep];
      const choices = shuffle(decoys).slice(0,4);
      const items = shuffle([...choices, intrus]);
      const gameArea = document.getElementById('gameArea'); gameArea.innerHTML = '';
      items.forEach(item => {
        const div = document.createElement('div'); 
        div.className = 'item';
        
        // Container pour l'image
        const imgContainer = document.createElement('div');
        imgContainer.style.flex = '1';
        imgContainer.style.display = 'flex';
        imgContainer.style.alignItems = 'center';
        imgContainer.style.justifyContent = 'center';
        
        // Image avec le bon nom de fichier
        const img = document.createElement('img');
        img.src = `images/${imageMapping[item]}`;
        img.alt = item;
        img.onerror = function() {
          // Fallback si l'image n'est pas trouv√©e - affiche juste le nom
          imgContainer.innerHTML = `<div style="text-align:center; font-size:0.9em; color:#666;">üì∑<br>Image manquante</div>`;
        };
        imgContainer.appendChild(img);
        
        // Nom de l'esp√®ce
        const nameDiv = document.createElement('div');
        nameDiv.className = 'item-name';
        nameDiv.textContent = item;
        
        div.appendChild(imgContainer);
        div.appendChild(nameDiv);
        div.onclick = () => handleClick(item, intrus);
        gameArea.appendChild(div);
      });
    }

    function handleClick(item, intrus) {
      const msg = document.getElementById('message');
      // Image d√©taill√©e et d√©finition
      const detailImg = `<img src="images/${imageMapping[item]}" alt="${item}">`;
      infoDiv.innerHTML = detailImg + definitions[item];
      
      if (item === intrus) {
        wrongStreak = 0;
        correctStreak++;
        const bonus = 4 + correctStreak; // 5,6,7...
        score += bonus;
        msg.textContent = `‚úÖ Bravo ! Intrus prot√©g√© : ${item} (+${bonus} pts)`;
        msg.style.color = '#27ae60';
        currentStep++; updateScore();
        setTimeout(() => {
          if (currentStep < currentLevel.length) showStep(); else finishGame();
        }, 3000);
      } else {
        correctStreak = 0;
        wrongStreak++;
        score = Math.max(0, score - wrongStreak);
        msg.textContent = `‚ùå ${item} n'est pas une esp√®ce √† prot√©ger (‚àí${wrongStreak} pts)`;
        msg.style.color = '#c0392b';
        updateScore();
      }
    }

    function finishGame() {
      document.getElementById('gameArea').innerHTML = '';
      document.getElementById('message').textContent = `üéâ Bravo ! Ton score final est ${score} points.`;
      infoDiv.innerHTML = '';
      levelButtons.style.display = 'block';
      scoreDisplay.style.display = 'none';
    }

    function updateScore() { scoreDisplay.textContent = `Score : ${score}`; }
    function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }
  </script>
</body>
</html>
