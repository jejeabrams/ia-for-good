<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jeu : Trouve l'intrus - Les H√©ros Invisibles</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      padding: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #2c3e50;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Animation de fond */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
      animation: float 6s ease-in-out infinite;
      z-index: -1;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(1deg); }
    }

    /* Container principal */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 15px;
    }

    /* Titre principal */
    h1 {
      color: #fff;
      font-size: clamp(1.5rem, 4vw, 2.5rem);
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      font-weight: 700;
    }

    .subtitle {
      color: rgba(255,255,255,0.9);
      font-size: clamp(0.9rem, 2.5vw, 1.1rem);
      margin-bottom: 25px;
      font-weight: 300;
    }

    /* Boutons de niveau */
    #level-buttons {
      margin: 25px 0;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }

    #level-buttons button {
      padding: 15px 25px;
      background: linear-gradient(45deg, #ff6b6b, #ee5a52);
      border: none;
      color: #fff;
      border-radius: 25px;
      cursor: pointer;
      font-size: clamp(0.9rem, 2.5vw, 1rem);
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(238, 90, 82, 0.4);
      min-width: 140px;
    }

    #level-buttons button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(238, 90, 82, 0.6);
      background: linear-gradient(45deg, #ee5a52, #ff6b6b);
    }

    #level-buttons button:active {
      transform: translateY(0);
    }

    /* Score */
    .score {
      font-size: clamp(1.1rem, 3vw, 1.4rem);
      margin: 20px 0;
      color: #fff;
      font-weight: 600;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border-radius: 20px;
      padding: 12px 20px;
      display: inline-block;
      border: 1px solid rgba(255,255,255,0.2);
    }

    /* Zone de jeu */
    .game-area {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 15px;
      margin: 25px 0;
      padding: 0 10px;
    }

    /* Cartes des esp√®ces */
    .item {
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      height: 180px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      padding: 15px;
      position: relative;
      overflow: hidden;
    }

    .item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s;
    }

    .item:hover::before {
      left: 100%;
    }

    .item:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: 0 15px 35px rgba(0,0,0,0.2);
      border-color: #667eea;
    }

    .item img {
      max-width: 90%;
      max-height: 110px;
      object-fit: cover;
      border-radius: 12px;
      transition: transform 0.3s ease;
    }

    .item:hover img {
      transform: scale(1.05);
    }

    .item-name {
      font-size: clamp(0.7rem, 2vw, 0.85rem);
      font-weight: 600;
      color: #2c3e50;
      margin-top: 8px;
      text-align: center;
      line-height: 1.2;
    }

    /* Messages */
    .message {
      margin: 25px 0;
      font-weight: 600;
      font-size: clamp(1rem, 3vw, 1.3rem);
      padding: 15px 20px;
      border-radius: 15px;
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Zone d'informations */
    .info {
      margin: 20px auto;
      font-size: clamp(0.85rem, 2.2vw, 0.95rem);
      text-align: left;
      padding: 20px;
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 20px;
      max-width: 700px;
      line-height: 1.5;
      white-space: pre-line;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .info img {
      width: 100%;
      max-width: 300px;
      border-radius: 15px;
      margin-bottom: 15px;
      display: block;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }

    /* Responsive design */
    @media (max-width: 768px) {
      body {
        padding: 15px 10px;
      }
      
      .game-area {
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        gap: 12px;
        padding: 0 5px;
      }
      
      .item {
        height: 160px;
        padding: 12px;
      }
      
      .item img {
        max-height: 90px;
      }
      
      #level-buttons {
        flex-direction: column;
        align-items: center;
      }
      
      #level-buttons button {
        width: 100%;
        max-width: 280px;
      }
    }

    @media (max-width: 480px) {
      .game-area {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      
      .item {
        height: 140px;
        padding: 10px;
      }
      
      .item img {
        max-height: 75px;
      }
      
      .info {
        padding: 15px;
        margin: 15px 10px;
      }
    }

    /* Animations d'entr√©e */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .item {
      animation: fadeInUp 0.6s ease forwards;
    }

    .item:nth-child(2) { animation-delay: 0.1s; }
    .item:nth-child(3) { animation-delay: 0.2s; }
    .item:nth-child(4) { animation-delay: 0.3s; }
    .item:nth-child(5) { animation-delay: 0.4s; }
    .item:nth-child(6) { animation-delay: 0.5s; }
    .item:nth-child(7) { animation-delay: 0.6s; }
    .item:nth-child(8) { animation-delay: 0.7s; }

    /* Style pour le message de succ√®s/erreur */
    .message.success {
      background: linear-gradient(45deg, #4ecdc4, #44a08d);
      color: white;
      animation: pulse 0.6s ease;
    }

    .message.error {
      background: linear-gradient(45deg, #ff6b6b, #ee5a52);
      color: white;
      animation: shake 0.6s ease;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    /* Am√©lioration du contraste pour l'accessibilit√© */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚≠ê Trouve l'intrus : Les H√©ros Invisibles ‚≠ê</h1>
    <p class="subtitle">Le but ? D√©masquer l'esp√®ce en danger pour mieux la prot√©ger !</p>
    
    <div id="level-buttons">
      <button onclick="startGame('facile')">üü¢ Facile (4 choix)</button>
      <button onclick="startGame('moyen')">üü° Moyen (6 choix)</button>
      <button onclick="startGame('difficile')">üî¥ Difficile (8 choix)</button>
    </div>
    
    <div class="score" id="scoreDisplay" style="display:none;">Score : 0</div>
    <div class="game-area" id="gameArea"></div>
    <div class="message" id="message"></div>
    <div class="info" id="info"></div>
  </div>

  <script>
    // === LISTES DES ESP√àCES ===
    
    // ü¶∏ Intrus (esp√®ces menac√©es √† prot√©ger)
    const endangeredSpecies = [
      "M√©lib√©e",
      "Vanesse des pari√©taires", 
      "Agrion bleuissant",
      "Cordulie splendide",
      "Serratella mesoleuca",
      "Halictus carinthiacus",
      "Bourdon velout√©",
      "Criquet de la Crau",
      "Phasme du palmiste rouge",
      "Dendrobias maxillosus"
    ];

    // üêû D√©coys (esp√®ces non menac√©es)
    const commonSpecies = [
      "Chauve-souris frugivore",
      "Colibri",
      "Mouche domestique",
      "Fourmi noire",
      "Papillon commun",
      "Abeille domestique",
      "Sauterelle verte",
      "Scarab√©e commun",
      "Coccinelle √† sept points",
      "Termite des for√™ts",
      "Grillon champ√™tre",
      "Larve de coccinelle",
      "Cicadelle",
      "Lucane cerf-volant",
      "Punaise verte",
      "Mite des v√™tements",
      "Perce-oreille",
      "Loup",
      "Renard",
      "Chat",
      "Chien",
      "Pigeon"
    ];

    // === D√âFINITIONS ET GESTES DE PROTECTION ===
    const definitions = {
      // Esp√®ces menac√©es
      "M√©lib√©e": `ü¶ã **M√©lib√©e**
1. Papillon rare des prairies humides, reconnaissable √† ses ailes oranges tachet√©es de noir.
2. Pollinisateur sp√©cialis√© des fleurs de prairie, indispensable √† la biodiversit√© montagnarde.
3. Menac√© par l'ass√®chement des zones humides et l'agriculture intensive.
**Gestes** : Pr√©serve les prairies fleuries, √©vite les pesticides, cr√©e des corridors verts.`,

      "Vanesse des pari√©taires": `ü¶ã **Vanesse des pari√©taires**
1. Papillon aux ailes d√©coup√©es, d√©pendant exclusivement de la pari√©taire officinale.
2. Exemple parfait de co√©volution : chenille-plante h√¥te indissociables.
3. Menac√©e par le nettoyage urbain et l'usage d'herbicides.
**Gestes** : Laisse pousser la pari√©taire sur tes murs, √©vite les d√©sherbants chimiques.`,

      "Agrion bleuissant": `üíß **Agrion bleuissant**
1. Petite libellule bleue vivant pr√®s des cours d'eau clairs et oxyg√©n√©s.
2. Pr√©dateur de moustiques efficace, indicateur de qualit√© des milieux aquatiques.
3. Menac√© par la pollution de l'eau et l'artificialisation des berges.
**Gestes** : Prot√®ge les ruisseaux, √©vite les produits chimiques pr√®s de l'eau.`,

      "Cordulie splendide": `‚ú® **Cordulie splendide**
1. Libellule m√©tallique des mares temporaires m√©diterran√©ennes.
2. Vol spectaculaire et chasse a√©rienne remarquable contre les insectes nuisibles.
3. Menac√©e par la disparition des zones humides temporaires.
**Gestes** : Cr√©e des mares naturelles, respecte les flaques temporaires.`,

      "Serratella mesoleuca": `üí¶ **Serratella mesoleuca**
1. √âph√©m√®re aux larves aquatiques, vie adulte de quelques heures seulement.
2. Maillon essentiel de la cha√Æne alimentaire des rivi√®res.
3. Menac√©e par la pollution et la modification des cours d'eau.
**Gestes** : Prot√®ge la v√©g√©tation des berges, √©vite les rejets polluants.`,

      "Halictus carinthiacus": `üêù **Halictus carinthiacus**
1. Abeille sauvage solitaire, excellente pollinisatrice des fleurs alpines.
2. Creuse ses nids dans le sol, plus efficace que l'abeille domestique sur certaines fleurs.
3. Menac√©e par l'urbanisation et le pi√©tinement des sols.
**Gestes** : Pr√©serve les sols nus, plante des fleurs locales, √©vite le b√™chage.`,

      "Bourdon velout√©": `üêù **Bourdon velout√©**
1. Bourdon au pelage dense, sp√©cialis√© dans la pollinisation par vibration.
2. Pollinisateur irrempla√ßable des tomates et autres solanac√©es.
3. Menac√© par les pesticides et la rar√©faction des fleurs sauvages.
**Gestes** : Plante des fleurs mellif√®res, bannis les insecticides, cr√©e des abris.`,

      "Criquet de la Crau": `ü¶ó **Criquet de la Crau**
1. Criquet end√©mique de la plaine de la Crau, habitat unique au monde.
2. Indicateur de la sant√© des √©cosyst√®mes de coussouls (pelouses s√®ches).
3. Menac√© par l'urbanisation et l'agriculture intensive.
**Gestes** : Soutiens la protection des espaces naturels, respecte les pelouses s√®ches.`,

      "Phasme du palmiste rouge": `üåø **Phasme du palmiste rouge**
1. Insecte-b√¢ton tropical, ma√Ætre du camouflage dans les palmiers.
2. Herbivore sp√©cialis√©, participant √† l'√©quilibre des for√™ts tropicales.
3. Menac√© par la d√©forestation et les esp√®ces invasives.
**Gestes** : Soutiens la protection des for√™ts tropicales, choisis des produits durables.`,

      "Dendrobias maxillosus": `ü™≤ **Dendrobias maxillosus**
1. Col√©opt√®re saproxylique, d√©composeur de bois mort essentiel.
2. Indicateur de la qualit√© des vieilles for√™ts, recycleur naturel.
3. Menac√© par l'exploitation foresti√®re intensive et le nettoyage des for√™ts.
**Gestes** : Laisse du bois mort en for√™t, soutiens la gestion durable des for√™ts.`,

      // Esp√®ces communes (descriptions plus courtes)
      "Chauve-souris frugivore": `ü¶á **Chauve-souris frugivore**
Mammif√®re volant, disperse les graines des fruits.
Population stable, adaptable aux environnements vari√©s.`,

      "Colibri": `üê¶ **Colibri**
Oiseau-mouche, pollinisateur de fleurs tubulaires.
Esp√®ce commune dans son habitat naturel.`,

      "Mouche domestique": `ü™∞ **Mouche domestique**
Insecte ubiquiste, recycle la mati√®re organique.
Tr√®s commune, non menac√©e.`,

      "Fourmi noire": `üêú **Fourmi noire**
Insecte social, a√®re le sol et disperse les graines.
Population abondante et stable.`,

      "Papillon commun": `ü¶ã **Papillon commun**
Pi√©ride blanche, pollinisateur occasionnel des jardins.
Tr√®s r√©pandu, population en bonne sant√©.`,

      "Abeille domestique": `üêù **Abeille domestique**
Hym√©nopt√®re √©lev√© par l'homme, pollinisateur efficace.
G√©r√©e par l'apiculture, non sauvage.`,

      "Sauterelle verte": `ü¶ó **Sauterelle verte**
Orthopt√®re herbivore des prairies et jardins.
Commune partout, tr√®s adaptable.`,

      "Scarab√©e commun": `ü™≤ **Scarab√©e commun**
Col√©opt√®re d√©composeur, recycle la mati√®re organique.
Population stable, pas de menace particuli√®re.`,

      "Coccinelle √† sept points": `üêû **Coccinelle √† sept points**
Pr√©dateur naturel des pucerons, auxiliaire du jardinier.
Tr√®s commune, non menac√©e.`,

      "Termite des for√™ts": `üêú **Termite des for√™ts**
Insecte social d√©composeur, recycle le bois mort.
Population stable dans les for√™ts.`,

      "Grillon champ√™tre": `ü¶ó **Grillon champ√™tre**
Orthopt√®re chanteur des prairies et jardins.
Tr√®s commun, non menac√©.`,

      "Larve de coccinelle": `üêõ **Larve de coccinelle**
Stade juv√©nile de coccinelle, grand pr√©dateur de pucerons.
Abondante, non menac√©e.`,

      "Cicadelle": `ü¶ó **Cicadelle**
Petit insecte sauteur se nourrissant de s√®ve.
Tr√®s commune, non menac√©e.`,

      "Lucane cerf-volant": `ü™≤ **Lucane cerf-volant**
Grand col√©opt√®re aux mandibules impressionnantes.
Relativement commun, non menac√© globalement.`,

      "Punaise verte": `üêõ **Punaise verte**
Insecte herbivore des jardins et cultures.
Tr√®s commune, parfois consid√©r√©e comme nuisible.`,

      "Mite des v√™tements": `ü¶ã **Mite des v√™tements**
Petit papillon dont la larve mange les textiles.
Tr√®s commune dans les habitations.`,

      "Perce-oreille": `ü¶ó **Perce-oreille**
Insecte aux pinces caract√©ristiques, omnivore.
Tr√®s commun, non menac√©.`,

      "Loup": `üê∫ **Loup**
Mammif√®re carnivore, pr√©dateur apex.
Population en r√©cup√©ration, non insecte.`,

      "Renard": `ü¶ä **Renard**
Mammif√®re omnivore adaptable.
Population stable, non insecte.`,

      "Chat": `üê± **Chat**
Mammif√®re domestique, pr√©dateur d'oiseaux et petits animaux.
Tr√®s commun, non insecte.`,

      "Chien": `üê∂ **Chien**
Mammif√®re domestique, compagnon de l'homme.
Tr√®s commun, non insecte.`,

      "Pigeon": `üê¶ **Pigeon**
Oiseau urbain tr√®s adaptable.
Tr√®s commun en ville, non insecte.`
    };

    // === CONFIGURATION DU JEU ===
    const gameConfig = {
      facile: { choices: 4, rounds: 5 },
      moyen: { choices: 6, rounds: 7 },
      difficile: { choices: 8, rounds: 10 }
    };

    // Variables de jeu
    let score = 0;
    let correctStreak = 0;
    let wrongStreak = 0;
    let currentRound = 0;
    let totalRounds = 0;
    let currentLevel = '';
    let usedEndangered = [];

    const scoreDisplay = document.getElementById('scoreDisplay');
    const infoDiv = document.getElementById('info');
    const levelButtons = document.getElementById('level-buttons');
    const messageDiv = document.getElementById('message');
    const gameArea = document.getElementById('gameArea');

    // === FONCTIONS UTILITAIRES ===
    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    function getImagePath(speciesName) {
      return `images/${speciesName}.jpg`;
    }

    // === D√âMARRAGE DU JEU ===
    function startGame(level) {
      currentLevel = level;
      currentRound = 0;
      score = 0;
      correctStreak = 0;
      wrongStreak = 0;
      usedEndangered = [];
      
      totalRounds = gameConfig[level].rounds;
      
      levelButtons.style.display = 'none';
      scoreDisplay.style.display = 'block';
      updateScore();
      infoDiv.innerHTML = '';
      
      showRound();
    }

    // === AFFICHAGE D'UNE MANCHE ===
    function showRound() {
      infoDiv.innerHTML = '';
      messageDiv.textContent = `Manche ${currentRound + 1}/${totalRounds}`;
      messageDiv.className = 'message';
      
      // Choisir un intrus qui n'a pas encore √©t√© utilis√©
      const availableEndangered = endangeredSpecies.filter(species => !usedEndangered.includes(species));
      if (availableEndangered.length === 0) {
        // Si tous ont √©t√© utilis√©s, on recommence la liste
        usedEndangered = [];
      }
      
      const intrus = availableEndangered[Math.floor(Math.random() * availableEndangered.length)];
      usedEndangered.push(intrus);
      
      // Choisir les d√©coys
      const nbChoices = gameConfig[currentLevel].choices;
      const choices = shuffle(commonSpecies).slice(0, nbChoices - 1);
      
      // M√©langer tous les √©l√©ments
      const items = shuffle([...choices, intrus]);
      
      // Afficher les cartes
      gameArea.innerHTML = '';
      items.forEach((item, index) => {
        const div = document.createElement('div');
        div.className = 'item';
        div.style.animationDelay = `${index * 0.1}s`;
        
        // Container pour l'image
        const imgContainer = document.createElement('div');
        imgContainer.style.flex = '1';
        imgContainer.style.display = 'flex';
        imgContainer.style.alignItems = 'center';
        imgContainer.style.justifyContent = 'center';
        
        // Image
        const img = document.createElement('img');
        img.src = getImagePath(item);
        img.alt = item;
        img.onerror = function() {
          imgContainer.innerHTML = `<div style="text-align:center; font-size:0.9em; color:#666;">üì∑<br>Image manquante</div>`;
        };
        imgContainer.appendChild(img);
        
        // Nom de l'esp√®ce
        const nameDiv = document.createElement('div');
        nameDiv.className = 'item-name';
        nameDiv.textContent = item;
        
        div.appendChild(imgContainer);
        div.appendChild(nameDiv);
        div.onclick = () => handleClick(item, intrus);
        gameArea.appendChild(div);
      });
    }

    // === GESTION DU CLIC ===
    function handleClick(item, intrus) {
      // Afficher les informations sur l'esp√®ce
      const detailImg = `<img src="${getImagePath(item)}" alt="${item}">`;
      infoDiv.innerHTML = detailImg + definitions[item];
      
      if (item === intrus) {
        // Bonne r√©ponse !
        wrongStreak = 0;
        correctStreak++;
        const bonus = 10 + correctStreak * 2; // 12, 14, 16...
        score += bonus;
        messageDiv.textContent = `‚úÖ Bravo ! Esp√®ce prot√©g√©e : ${item} (+${bonus} pts)`;
        messageDiv.className = 'message success';
        
        currentRound++;
        updateScore();
        
        setTimeout(() => {
          if (currentRound < totalRounds) {
            showRound();
          } else {
            finishGame();
          }
        }, 3000);
        
      } else {
        // Mauvaise r√©ponse
        correctStreak = 0;
        wrongStreak++;
        const penalty = wrongStreak * 3;
        score = Math.max(0, score - penalty);
        messageDiv.textContent = `‚ùå ${item} n'est pas une esp√®ce √† prot√©ger (-${penalty} pts)`;
        messageDiv.className = 'message error';
        updateScore();
      }
    }

    // === FIN DE PARTIE ===
    function finishGame() {
      gameArea.innerHTML = '';
      
      let performance = '';
      if (score >= totalRounds * 10) performance = 'üèÜ Excellent !';
      else if (score >= totalRounds * 7) performance = 'ü•á Tr√®s bien !';
      else if (score >= totalRounds * 5) performance = 'ü•à Bien !';
      else performance = 'ü•â √Ä am√©liorer !';
      
      messageDiv.innerHTML = `
        <div style="font-size: 1.4em; margin-bottom: 10px;">${performance}</div>
        <div>Score final : ${score} points</div>
        <div style="font-size: 0.9em; margin-top: 10px;">
          Merci d'avoir jou√© pour la protection de la biodiversit√© !
        </div>
      `;
      messageDiv.className = 'message success';
      
      infoDiv.innerHTML = '';
      levelButtons.style.display = 'flex';
      scoreDisplay.style.display = 'none';
    }

    // === MISE √Ä JOUR DU SCORE ===
    function updateScore() {
      scoreDisplay.textContent = `Score : ${score}`;
    }
  </script>
</body>
</html>
