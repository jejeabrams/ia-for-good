<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jeu : Trouve l'intrus - Les H√©ros Invisibles</title>
  <style>
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      text-align: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #2c3e50;
      padding: 15px;
      margin: 0;
      min-height: 100vh;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
    }
    
    h1 {
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 2rem;
      margin-bottom: 15px;
      line-height: 1.2;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 1.2rem;
      margin-bottom: 25px;
      color: #34495e;
      font-weight: 500;
      padding: 0 15px;
      line-height: 1.4;
    }
    
    #level-buttons {
      margin: 25px 0;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
    }
    
    #level-buttons button {
      padding: 15px 25px;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      border: none;
      color: white;
      border-radius: 15px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      min-width: 120px;
      box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    #level-buttons button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(39, 174, 96, 0.4);
      background: linear-gradient(45deg, #2ecc71, #27ae60);
    }
    
    .score-container {
      margin: 20px 0;
      display: none;
    }
    
    .score {
      font-size: 1.4rem;
      font-weight: bold;
      padding: 12px 25px;
      background: linear-gradient(45deg, #3498db, #2980b9);
      color: white;
      border-radius: 25px;
      display: inline-block;
      box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
      min-width: 150px;
    }
    
    .game-area {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 15px;
      margin: 30px 0;
      padding: 0 10px;
    }
    
    .item {
      background: linear-gradient(145deg, #ffffff, #f8f9fa);
      border: 3px solid #27ae60;
      border-radius: 15px;
      min-height: 160px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      padding: 15px;
      text-align: center;
      word-wrap: break-word;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      line-height: 1.3;
      color: #2c3e50;
      position: relative;
      overflow: hidden;
    }
    
    .item img {
      max-width: 80px;
      max-height: 80px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .item-name {
      font-size: 0.9rem;
      font-weight: 600;
      text-align: center;
      line-height: 1.2;
    }
    
    .item:hover {
      transform: translateY(-5px) scale(1.03);
      box-shadow: 0 10px 25px rgba(39, 174, 96, 0.2);
      border-color: #2ecc71;
    }
    
    .item:active {
      transform: translateY(-2px) scale(1.01);
    }
    
    .message {
      margin: 25px auto;
      font-weight: 600;
      font-size: 1.3rem;
      padding: 20px;
      border-radius: 15px;
      max-width: 90%;
      line-height: 1.4;
      transition: all 0.3s ease;
      opacity: 0;
      transform: translateY(20px);
    }
    
    .message.show {
      opacity: 1;
      transform: translateY(0);
    }
    
    .message.success {
      background: linear-gradient(135deg, #d4edda, #c3e6cb);
      color: #155724;
      border: 2px solid #b8daff;
      box-shadow: 0 5px 15px rgba(21, 87, 36, 0.1);
    }
    
    .message.error {
      background: linear-gradient(135deg, #f8d7da, #f5c6cb);
      color: #721c24;
      border: 2px solid #f1b0b7;
      box-shadow: 0 5px 15px rgba(114, 28, 36, 0.1);
    }
    
    .info {
      margin: 25px auto;
      font-size: 1rem;
      text-align: left;
      padding: 25px;
      background: linear-gradient(135deg, #e8f8f5, #d1f2eb);
      border: 2px solid #27ae60;
      border-radius: 15px;
      max-width: 90%;
      line-height: 1.6;
      white-space: pre-line;
      box-shadow: 0 5px 15px rgba(39, 174, 96, 0.1);
      display: none;
    }
    
    .info.show {
      display: block;
      animation: slideIn 0.5s ease;
    }
    
    .info img {
      width: 100%;
      max-width: 300px;
      height: auto;
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .progress-bar {
      width: 100%;
      height: 6px;
      background: #ecf0f1;
      border-radius: 3px;
      margin: 20px 0;
      overflow: hidden;
      display: none;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      width: 0%;
      transition: width 0.5s ease;
      border-radius: 3px;
    }
    
    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      margin: 20px 0;
      gap: 15px;
    }
    
    .level-indicator {
      font-size: 1.1rem;
      font-weight: 600;
      color: #34495e;
      padding: 8px 15px;
      background: #f8f9fa;
      border-radius: 20px;
      border: 2px solid #e9ecef;
    }
    
    /* Responsive Design */
    @media (max-width: 480px) {
      .container {
        margin: 10px;
        padding: 20px;
        border-radius: 15px;
      }
      
      h1 {
        font-size: 1.7rem;
      }
      
      .subtitle {
        font-size: 1.1rem;
      }
      
      .game-area {
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      
      .item {
        min-height: 140px;
        font-size: 0.9rem;
        padding: 12px;
      }
      
      .item img {
        max-width: 60px;
        max-height: 60px;
      }
      
      .item-name {
        font-size: 0.8rem;
      }
      
      #level-buttons button {
        font-size: 1rem;
        padding: 12px 20px;
        min-width: 100px;
      }
      
      .game-header {
        flex-direction: column;
        text-align: center;
      }
    }
    
    @media (min-width: 768px) {
      .game-area {
        grid-template-columns: repeat(3, 1fr);
      }
      
      .item {
        min-height: 180px;
      }
      
      .item img {
        max-width: 100px;
        max-height: 100px;
      }
      
      h1 {
        font-size: 2.5rem;
      }
      
      .subtitle {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚≠ê Trouve l'intrus : Les H√©ros Invisibles ‚≠ê</h1>
    <p class="subtitle">Le but ? D√©masquer l'insecte en danger pour mieux le prot√©ger !</p>
    
    <div id="level-buttons">
      <button onclick="startGame('facile')">üå± Facile</button>
      <button onclick="startGame('moyen')">üåø Moyen</button>
      <button onclick="startGame('difficile')">üå≥ Difficile</button>
    </div>
    
    <div class="game-header" id="gameHeader" style="display: none;">
      <div class="level-indicator" id="levelIndicator"></div>
      <div class="score-container">
        <div class="score" id="scoreDisplay">Score: 0</div>
      </div>
    </div>
    
    <div class="progress-bar" id="progressBar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    
    <div class="game-area" id="gameArea"></div>
    <div class="message" id="message"></div>
    <div class="info" id="info"></div>
  </div>

  <script>
    // Mapping exact des noms d'esp√®ces aux fichiers d'images
    const imageMapping = {
      "M√©lib√©e": "Melib√©e.jpg",
      "Agrion bleuissant": "Agrion bleuissant (Ischnura elegans).jpg",
      "Cordulie splendide": "Cordulie splendide (Somatochlora metallica).jpg",
      "Serratella mesoleuca": "Serratella mesoleuca (Serratella mesoleuca).jpg",
      "Vanesse des pari√©taires": "Vanesse des pari√©taires.jpg",
      "Mouche domestique": "mouche .jpg",
      "Fourmi": "Fourmi noire (Lasius niger).jpg",
      "Papillon commun": "Papillon citron (Gonepteryx rhamni) .jpg",
      "Scarab√©e commun": "Scarab√©e commun (Geotrupes stercorarius or Scarabaeus sacer).jpg",
      "Sauterelle verte": "Grillon champ√™tre (Gryllus campestris).jpg"
    };

    // D√©finitions type Wikip√©dia et gestes
    const definitions = {
      "M√©lib√©e": `üêõ **M√©lib√©e**
1. Insecte sauvage des prairies humides montagneuses, ailes gris-brun orn√©es d'ocelles orang√©s.
2. Pollinisateur essentiel du tr√®fle, base de la cha√Æne alimentaire locale.
3. Menac√© par la disparition des prairies humides et les monocultures.
**Gestes** : Plante des gramin√©es et fleurs sauvages, prot√®ge les zones humides pr√®s de chez toi.`,
      "Agrion bleuissant": `üíß **Agrion bleuissant**
1. Petite libellule aquatique au corps bleu et noir, larves vivant dans les ruisseaux clairs.
2. R√©gulateur naturel des populations de moustiques, indicateur de qualit√© de l'eau.
3. Menac√© par l'ass√®chement des cours d'eau et la pollution agricole.
**Gestes** : Cr√©e un petit bassin sans pesticides, plante une bande tampon v√©g√©talis√©e.`,
      "Cordulie splendide": `‚ú® **Cordulie splendide**
1. Libellule au corps m√©tallique vert, fr√©quente les mares m√©diterran√©ennes.
2. Pr√©dateur efficace des moustiques, gr√¢ce √† son vol acrobatique.
3. Menac√©e par la pollution lumineuse et la destruction des zones humides.
**Gestes** : Installe des √©clairages √† spectre adapt√©, restaure et prot√®ge les mares locales.`,
      "Serratella mesoleuca": `üí¶ **Serratella mesoleuca**
1. √âph√©m√®re d'eau douce, nymphes aquatiques jusqu'√† 3 ans avant leur vie br√®ve de quelques heures.
2. Nourrit essentiel pour poissons et oiseaux, bio-indicateur des rivi√®res saines.
3. Menac√©e par le dragage et l'artificialisation des berges.
**Gestes** : Encourage la v√©g√©tation naturelle des berges, limite les travaux lourds en rivi√®re.`,
      "Vanesse des pari√©taires": `ü¶ã **Vanesse des pari√©taires**
1. Papillon fauve aux ailes tr√®s d√©coup√©es, vivant sur les murs chauds o√π pousse la pari√©taire.
2. Chenille d√©pendante de la pari√©taire officinale, illustrant l'importance des plantes-h√¥tes.
3. Menac√©e par la b√©tonisation et le nettoyage des murs.
**Gestes** : Laisse pousser la pari√©taire sur un mur, √©vite les herbicides et nettoyages intempestifs.`,
      // D√©coys succincts
      "Mouche domestique": `ü™∞ **Mouche domestique**
Insecte ubiquitaire, recycle les d√©chets organiques.
Non menac√©e, pas besoin de protection.`,
      "Fourmi": `üêú **Fourmi**
Sociale, vit en colonies complexes, a√®re le sol.
Esp√®ce commune, non en danger.`,
      "Papillon commun": `ü¶ã **Papillon commun (pi√©ride)**
Blanc fr√©quent dans les jardins, pollinise occasionnellement.
R√©silient, non menac√©.`,
      "Scarab√©e commun": `ü™≤ **Scarab√©e commun**
Col√©opt√®re d√©truisant la mati√®re organique morte.
Population stable, pas besoin de mesures sp√©ciales.`,
      "Sauterelle verte": `ü¶ó **Sauterelle verte**
Sauteuse des prairies, herbivore mod√©r√©.
Commun, non menac√©e.`
    };

    // Param√®tres de jeu
    const levels = {
      facile: ["M√©lib√©e","Agrion bleuissant","Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires"],
      moyen: ["Agrion bleuissant","Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires","M√©lib√©e"],
      difficile: ["Cordulie splendide","Serratella mesoleuca","Vanesse des pari√©taires","M√©lib√©e","Agrion bleuissant"]
    };
    const decoys = ["Mouche domestique","Fourmi","Papillon commun","Scarab√©e commun","Sauterelle verte"];

    let score = 0, correctStreak = 0, wrongStreak = 0, currentLevel = [], currentStep = 0, currentLevelName = '';
    const scoreDisplay = document.getElementById('scoreDisplay');
    const infoDiv = document.getElementById('info');
    const levelButtons = document.getElementById('level-buttons');
    const gameHeader = document.getElementById('gameHeader');
    const levelIndicator = document.getElementById('levelIndicator');
    const progressBar = document.getElementById('progressBar');
    const progressFill = document.getElementById('progressFill');

    function startGame(level) {
      currentLevel = levels[level];
      currentLevelName = level;
      currentStep = 0;
      score = 0;
      correctStreak = 0;
      wrongStreak = 0;
      
      levelButtons.style.display = 'none';
      gameHeader.style.display = 'flex';
      progressBar.style.display = 'block';
      
      updateScore();
      updateLevelIndicator();
      updateProgress();
      hideMessage();
      hideInfo();
      showStep();
    }

    function showStep() {
      hideInfo();
      hideMessage();
      
      const intrus = currentLevel[currentStep];
      const choices = shuffle([...decoys]).slice(0, 4);
      const items = shuffle([...choices, intrus]);
      const gameArea = document.getElementById('gameArea');
      gameArea.innerHTML = '';

      items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'item';
        
        // Image
        const img = document.createElement('img');
        const imageName = imageMapping[item];
        if (imageName) {
          img.src = `images/${imageName}`;
          img.alt = item;
          img.onerror = function() {
            // Si l'image ne charge pas, on met une ic√¥ne par d√©faut
            this.style.display = 'none';
          };
        }
        
        // Nom de l'esp√®ce
        const nameDiv = document.createElement('div');
        nameDiv.className = 'item-name';
        nameDiv.textContent = item;
        
        div.appendChild(img);
        div.appendChild(nameDiv);
        div.onclick = () => handleClick(item, intrus, div);
        gameArea.appendChild(div);
      });
      
      updateProgress();
    }

    function handleClick(item, intrus, div) {
      // Afficher l'image d√©taill√©e et la d√©finition
      const imageName = imageMapping[item];
      let imageHtml = '';
      if (imageName) {
        imageHtml = `<img src="images/${imageName}" alt="${item}" style="width:100%;max-width:300px;border-radius:8px;margin-bottom:15px;">`;
      }
      infoDiv.innerHTML = imageHtml + definitions[item];
      showInfo();
      
      if (item === intrus) {
        wrongStreak = 0;
        correctStreak++;
        const bonus = 4 + correctStreak; // 5,6,7...
        score += bonus;
        showMessage(`‚úÖ Bravo ! Tu as sauv√© : ${item} (+${bonus} pts)`, 'success');
        
        // Effet visuel sur le bon bouton
        div.style.background = 'linear-gradient(145deg, #d4edda, #c3e6cb)';
        div.style.borderColor = '#28a745';
        div.style.transform = 'scale(1.05)';
        
        currentStep++;
        updateScore();
        updateProgress();
        
        // D√©sactiver tous les boutons apr√®s une victoire
        const allItems = document.querySelectorAll('.item');
        allItems.forEach(btn => btn.style.pointerEvents = 'none');
        
        setTimeout(() => {
          if (currentStep < currentLevel.length) {
            showStep();
          } else {
            finishGame();
          }
        }, 3000);
      } else {
        correctStreak = 0;
        wrongStreak++;
        score = Math.max(0, score - wrongStreak);
        showMessage(`‚ùå ${item} n'est pas en danger ! (‚àí${wrongStreak} pts)`, 'error');
        updateScore();
        
        // Effet visuel temporaire sur le bouton mal cliqu√©
        const originalBg = div.style.background;
        const originalBorder = div.style.borderColor;
        const originalTransform = div.style.transform;
        
        div.style.background = 'linear-gradient(145deg, #f8d7da, #f5c6cb)';
        div.style.borderColor = '#dc3545';
        div.style.transform = 'scale(0.95)';
        
        setTimeout(() => {
          div.style.background = originalBg;
          div.style.borderColor = originalBorder || '#27ae60';
          div.style.transform = originalTransform;
        }, 1000);
        
        setTimeout(() => {
          hideMessage();
        }, 2000);
      }
    }

    function finishGame() {
      const gameArea = document.getElementById('gameArea');
      gameArea.innerHTML = '';
      
      let finalMessage = '';
      if (score >= 40) {
        finalMessage = `üèÜ Incroyable ! Score parfait : ${score} points !`;
      } else if (score >= 25) {
        finalMessage = `üéâ Excellent ! Tu as sauv√© beaucoup d'insectes : ${score} points !`;
      } else {
        finalMessage = `üëç Bien jou√© ! Continue d'apprendre : ${score} points !`;
      }
      
      showMessage(finalMessage, 'success');
      hideInfo();
      
      setTimeout(() => {
        gameHeader.style.display = 'none';
        progressBar.style.display = 'none';
        levelButtons.style.display = 'flex';
        hideMessage();
      }, 4000);
    }

    function updateScore() {
      scoreDisplay.textContent = `Score: ${score}`;
    }
    
    function updateLevelIndicator() {
      const levelNames = {
        facile: 'üå± Niveau Facile',
        moyen: 'üåø Niveau Moyen', 
        difficile: 'üå≥ Niveau Difficile'
      };
      levelIndicator.textContent = levelNames[currentLevelName];
    }
    
    function updateProgress() {
      const progress = (currentStep / currentLevel.length) * 100;
      progressFill.style.width = progress + '%';
    }
    
    function showMessage(text, type) {
      const msg = document.getElementById('message');
      msg.textContent = text;
      msg.className = `message ${type} show`;
    }
    
    function hideMessage() {
      const msg = document.getElementById('message');
      msg.className = 'message';
      setTimeout(() => {
        msg.textContent = '';
      }, 300);
    }
    
    function showInfo(text) {
      const info = document.getElementById('info');
      if (text) {
        info.innerHTML = text;
      }
      info.className = 'info show';
    }
    
    function hideInfo() {
      const info = document.getElementById('info');
      info.className = 'info';
      setTimeout(() => {
        info.innerHTML = '';
      }, 300);
    }

    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }
  </script>
</body>
</html>
